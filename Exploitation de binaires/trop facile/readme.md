**Objectif :** Dans ce challenge, l'objectif est que l'utilisateur tape une chaîne de caractères depuis une console netcat. Le code source nous est fourni. 
ainsi que la version compilée. Le binaire nous montre qu'il s'agit d'un fichier *.ELF traditionnel d'un exécutable sous Linux. Il faut deviner quelle chaîne saisir pour obtenir le flag.
Pour cela, on regarde le code source fourni. On constate que les tests des variables check et key (ligne 16) sont inversés (variables croisées).
Si on arrive à les rétablir, on aura un shell system qui nous permettra très probablement d'obtenir le flag facilement.
 
1) On ne peut pas modifier les variables check et key par l'utilisateur du programme
2) fgets (ligne 14) permet de saisir 49 caractères et de les stocker dans le tableau buf.
3) Or, ce tableau est alloué pour 40 caractères uniquement. Les 9 caractères supplémentaires que l'on peut saisir vont provoquer un dépassement de capacité de la varaible buf et donc 
aller s'écrire au-delà dans la mémoir du programme. Justement, check et key sont allouées avant buf et font 4 octets chacune; ce qui tombe bien vu qu'on peut ajouter 9 caractères. 
On comprend donc que les 40 premiers caractères qui vont être saisis dans la variable buf ne servent à rien. Seuls les 9 caractères de fin vont être déterminants à la résolution.

On essaie de déterminer comment les caractères de check et key sont stockés dans la mémoire. C'est peut être assez évident pour les habitués des dépassements de capacités, mais iici,
dans la pratique, on a lancé le programme sous gdb. En mémoire, les données sont stockées de façon inversée au niveau des bits (big endian vs little endian).
Du coup, de ad be ef ca fe be be devient ef be ad de be be fe ca, donc on va saisir en HEXA : '\xef\xbe\xad\xde\xbe\xbe\xfe\xca' dans netcat en plus de 40 caractères inutilisés.
Le petit script en Python ci-joint lance l'appel et on obtient le shell prévu à l'énoncé. L'exploitation du shell obtenu est facile puisque le falg est tout simplement dans un fichier : flag.txt.
On l'affiche par exempla avec la commande cat.

Le flag est 404CTF{C_7r0P_F4C113_D3_PWN_14_H411384rD3}

Voir la solution.
